"use strict";(self.webpackChunkliwx_docs=self.webpackChunkliwx_docs||[]).push([[197],{5562:(e,i,n)=>{n.r(i),n.d(i,{comp:()=>a,data:()=>t});var d=n(641);const s=[(0,d.Fv)('<h1 id="uniapp使用renderjs" tabindex="-1"><a class="header-anchor" href="#uniapp使用renderjs"><span>uniapp使用renderjs</span></a></h1><p>参考：https://www.jb51.net/article/263532.htm</p><p>参考：https://www.jianshu.com/p/1fed6d0c658c</p><h3 id="一、基本使用" tabindex="-1"><a class="header-anchor" href="#一、基本使用"><span>一、基本使用</span></a></h3><blockquote><p>前提说明:在<code>template</code>页面中可以调用<code>script</code>和<code>renderjs</code>里面的方法，</p><p>但是两个<code>script</code>里面的方法不能相互调用。所以有了下面的写法。</p></blockquote><ul><li>1.在<code>script</code>的方法中调用<code>renderjs</code>的方法实现过程 <ul><li>1.通过修改<code>script</code>-<code>data</code>中的<code>msg</code>通知到<code>template</code>页面层</li><li>2.在<code>template</code>中监听<code>msg</code>数据变化并调用<code>renderjs</code>里面的方法。具体代码：<div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>:msg=&quot;msg&quot; :change:msg=&quot;renderJS.receiveMsg&quot;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li>3.在<code>renderjs</code>的方法中接收相应的值并执行相关逻辑</li></ul></li><li>2.在<code>renderjs</code>中调用<code>script</code>中的方法的实现过程：具体代码<div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>ownerVm.callMethod(&#39;receiveSendData&#39;, this.name)\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h4 id="_1-页面模版" tabindex="-1"><a class="header-anchor" href="#_1-页面模版"><span>1.页面模版</span></a></h4><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>&lt;template&gt;\n    &lt;view class=&quot;renderWrap&quot;&gt;\n        &lt;view&gt;\n            &lt;button type=&quot;primary&quot; @click=&quot;renderJS.sendData&quot;&gt;直接调用renderjs中的sendData方法&lt;/button&gt;\n            \n            &lt;button type=&quot;warn&quot; @click=&quot;changeMsg&quot;&gt;点击修改msg值&lt;/button&gt;\n            \n            &lt;view  :msg=&quot;msg&quot; :change:msg=&quot;renderJS.receiveMsg&quot;&gt;\n                {{msg}}\n            &lt;/view&gt;\n        &lt;/view&gt;\n    &lt;/view&gt;\n&lt;/template&gt;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-基础vue的script" tabindex="-1"><a class="header-anchor" href="#_2-基础vue的script"><span>2.基础vue的script</span></a></h4><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>&lt;script&gt;\n    export default {\n        data() {\n            return {\n                msg: &#39;看看Model层的msg&#39;\n            }\n        },\n        methods: {\n            // 触发service层 触发renderjs数据改变\n            changeMsg() {\n                this.msg = &quot;修改 msg 值，执行 receiveMsg 方法&quot;;\n            },\n            // 接收renderjs发回的数据\n            receiveSendData(val) {\n                this.msg = `Model 接收 View层 值：${val}`;\n            }   \n        }\n    }\n&lt;/script&gt;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-创建renderjs的module" tabindex="-1"><a class="header-anchor" href="#_3-创建renderjs的module"><span>3.创建renderjs的module</span></a></h4><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>&lt;script module=&quot;renderJS&quot; lang=&quot;renderjs&quot;&gt;\n    export default {\n        data() {\n            return {\n                name: &#39;我是renderjs module!&#39;,\n                message: &#39;&#39;\n            }\n        },\n        methods: {\n            // 接收逻辑层service层发送的数据\n            receiveMsg(newValue, oldValue, ownerVm, vm) {\n                console.log(&#39;监听 msg 值：&#39;, newValue, oldValue)\n            },\n            // 发送数据到service层\n            sendData(e, ownerVm) {\n                ownerVm.callMethod(&#39;receiveSendData&#39;, this.name)\n                // 或者\n                /* this.$ownerInstance.callMethod(&#39;receiveSendData&#39;,{\n                    content:this.content\n                }) */\n            }\n        }\n    }\n&lt;/script&gt;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="二、实际应用" tabindex="-1"><a class="header-anchor" href="#二、实际应用"><span>二、实际应用</span></a></h3><p>要实现的功能是：对于<code>v-html</code>渲染的图片标签实现点击可以预览的效果。</p><h4 id="_1-template页面" tabindex="-1"><a class="header-anchor" href="#_1-template页面"><span>1.<code>template</code>页面</span></a></h4><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>&lt;template&gt;\n  &lt;view id=&quot;contentView&quot;  class=&quot;imgStyle&quot; v-html=&quot;content&quot; :prop=&quot;currentTime&quot; :change:prop=&quot;detail.imgDetail&quot;&gt;&lt;/view&gt;\n&lt;/template&gt;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-script-标签" tabindex="-1"><a class="header-anchor" href="#_2-script-标签"><span>2.<code>&lt;script&gt;</code>标签</span></a></h4><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>&lt;script&gt;\n\nexport default {\n  data() {\n    return {\n      content: &#39;&#39;,\n      currentTime:&#39;&#39;,\n    }\n  },\n  onLoad(params) {\n    let infoid = params.infoid\n    this.getDetailData({infoid})\n  },\n  methods: {\n    previewImage({index, arr}){\n      let arrList = arr.map(item =&gt; { //获取当前页面的轮播图数据\n        if (item.url) {\n          return item.url\n        } else {\n          return item\n        }\n      })\n      //uniapp预览轮播图\n      if (arrList.length &gt; 0) {\n        uni.previewImage({\n          current: index, //预览图片的下标\n          urls: arrList, //预览图片的地址，必须要数组形式，如果不是数组形式就转换成数组形式就可以\n          indicator:&#39;number&#39;\n        })\n      }\n    },\n    getDetailData(data){//加载v-html里面的内容\n      uni.showLoading({title: &quot;加载中&quot;})\n      sublevel.zcfgListDetail(data).then(res =&gt; {\n        this.params = res.infotitle\n        this.content = res.content\n      }).finally(res =&gt; {\n          uni.hideLoading()\n          this.$nextTick(()=&gt;{\n            //使用currentTime更新调用renderjs里面的方法\n            this.currentTime=new Date().getTime()\n          })\n      })\n    }\n  }\n}\n&lt;/script&gt;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-renderjs标签" tabindex="-1"><a class="header-anchor" href="#_3-renderjs标签"><span>3.<code>renderjs</code>标签</span></a></h4><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>&lt;script module=&quot;detail&quot; lang=&quot;renderjs&quot;&gt;\nexport default {\n  data(){\n    return{\n      img_list:[]\n    }\n  },\n  methods:{\n    imgDetail(newValue, oldValue, ownerInstance, instance){\n      //在上面的v-html标签渲染完成后使用document获取contentView标签下面的img标签并设置相应的点击事件\n      let parentDom = window.document.getElementById(&#39;contentView&#39;)\n      if (parentDom &amp;&amp; parentDom.childNodes.length &gt; 0) {\n        let p_dom = parentDom.childNodes\n        p_dom.forEach(item=&gt;{\n          item.childNodes.forEach(item0=&gt;{\n            // console.log(&quot;item0&quot;,item0)\n            if (item0.nodeName === &quot;IMG&quot;) {\n              this.img_list.push(item0.src)\n              item0.addEventListener(&quot;click&quot;, (e) =&gt; {\n                //图片点击的时候调用script里面的previewImage预览图片\n                ownerInstance.callMethod(&#39;previewImage&#39;, {\n                  index: this.img_list.indexOf(e.target.src),\n                  arr: this.img_list\n                })\n              })\n            }\n          })\n        })\n      }\n    },\n  }\n}\n&lt;/script&gt;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',20)],l={},a=(0,n(6262).A)(l,[["render",function(e,i){return(0,d.uX)(),(0,d.CE)("div",null,s)}]]),t=JSON.parse('{"path":"/markdown/%E5%89%8D%E7%AB%AF/uniapp/uniapp%E4%BD%BF%E7%94%A8renderjs.html","title":"uniapp使用renderjs","lang":"zh-CN","frontmatter":{},"headers":[{"level":3,"title":"一、基本使用","slug":"一、基本使用","link":"#一、基本使用","children":[]},{"level":3,"title":"二、实际应用","slug":"二、实际应用","link":"#二、实际应用","children":[]}],"git":{},"filePathRelative":"markdown/前端/uniapp/uniapp使用renderjs.md"}')}}]);