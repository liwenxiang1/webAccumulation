"use strict";(self.webpackChunkliwx_docs=self.webpackChunkliwx_docs||[]).push([[1064],{1271:(n,s,a)=>{a.r(s),a.d(s,{comp:()=>o,data:()=>l});var p=a(641);const e=[(0,p.Fv)('<h2 id="如何提取复用代码给多个-entry-使用" tabindex="-1"><a class="header-anchor" href="#如何提取复用代码给多个-entry-使用"><span>如何提取复用代码给多个 entry 使用</span></a></h2><p>在 <code>Webpack</code> 中提取源码里被多个入口点复用的代码，例如一个 <code>utils</code> 文件，可以通过配置 <strong><code>optimization.splitChunks</code></strong> 来实现。<code>Webpack </code>会将这些频繁复用的模块提取出来，打包到一个独立的 <code>chunk</code> 中，使得浏览器可以<code>单独缓存这部分代码</code>，并在多个页面间共享使用，优化加载性能。</p><p>使用 <code>splitChunks</code> 的基本配置如下：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...其他配置...</span>\n  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 对所有的 chunk 有效，包括异步和非异步 chunk</span>\n      <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token literal-property property">commons</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;commons&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 提取出来的文件命名为 &#39;commons.js&#39;</span>\n          <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;initial&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 提取出的 chunk 类型，&#39;initial&#39; 为初始 chunk，&#39;async&#39; 为异步 chunk，&#39;all&#39; 表示全部 chunk</span>\n          <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 模块被引用&gt;=2次，便分割</span>\n          <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 模块的最小体积</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>这个配置的含义是：</strong></p><ul><li>chunks: &#39;all&#39; 指定要优化的 chunk 类型，这里设置为 all 代表所有的 chunk，不管是动态还是非动态加载的模块。</li><li>cacheGroups 是一个对象，用于定义缓存组，可以继承和/或覆盖 splitChunks 的任何选项。每个缓存组可以有自己的配置，将不同的模块提取到不同的文件中。</li><li>cacheGroups.commons 定义了一个缓存组，专门用于提取 initial chunk（最初依赖的模块）中被至少两个 chunk 所共享的模块。</li><li>name: &#39;commons&#39; 为生成的文件定义了一个自定义名称。</li><li>minChunks: 2 表示模块至少被两个入口点引用时，才会被提取。</li><li>minSize: 0 指定模块的最小体积是 0，即任意大小的模块都被提取。</li></ul><p>这会让任何从 node_modules 目录导入，并在至少两个入口点中使用的模块，都会被打包到一个名为 commons.js 的文件中（当然，实际的文件名会受到 output 配置的影响，例如是否包含哈希值等）。</p><p>正确配置这些参数后，utils 这样的模块就会被自动提取并共享，而不是在每个入口点的 bundle 中重复包含。这样做的好处是，任何更新业务逻辑的时候，只要 utils 没有发生变化，用户浏览器上已缓存的 commons.js 文件就不需要重新下载。</p>',8)],t={},o=(0,a(6262).A)(t,[["render",function(n,s){return(0,p.uX)(),(0,p.CE)("div",null,e)}]]),l=JSON.parse('{"path":"/mianshi/%E5%A6%82%E4%BD%95%E6%8F%90%E5%8F%96%E5%A4%8D%E7%94%A8%E4%BB%A3%E7%A0%81%E7%BB%99%E5%A4%9A%E4%B8%AA%20entry%20%E4%BD%BF%E7%94%A8.html","title":"","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"如何提取复用代码给多个 entry 使用","slug":"如何提取复用代码给多个-entry-使用","link":"#如何提取复用代码给多个-entry-使用","children":[]}],"git":{},"filePathRelative":"mianshi/如何提取复用代码给多个 entry 使用.md"}')}}]);